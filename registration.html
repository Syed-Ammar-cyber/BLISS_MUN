<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BLISSMUN Registration</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="registration.css">
    <script src="registration.js" defer></script>
</head>
<body>
    <div class="container">
        <div class="form-header">
            <div class="header-video">
                <video autoplay muted loop>
                    <source src="header-video.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <h2>BLISSMUN Registration Form</h2>
            <p>Please complete the form below to register</p>
        </div>
        <form action="https://sheetdb.io/api/v1/an343aw0in1z4" method = "post" id="sheetdb-form" class="form-body">
            <div class="input-group">
                <label for="name">Full Name <span class="required">*</span></label>
                <input type="text" id="name" name="data[name]" placeholder="Enter your full name" required>
            </div>
            
            <div class="input-group">
                <label for="age">Age <span class="required">*</span></label>
                <input type="number" id="age" name="data[age]" min="13" max="25" required>
            </div>
            
            <div class="input-group">
                <label for="email">Email <span class="required">*</span></label>
                <input type="email" id="email" name="data[email]" placeholder="Enter your email address" required>
            </div>
            
            <div class="input-group">
                <label for="grade">Grade/Year <span class="required">*</span></label>
                <input type="text" id="grade" name="data[grade]" placeholder="Enter your grade or year" required>
            </div>
            
            <div class="input-group">
                <label for="school">School/Institution <span class="required">*</span></label>
                <input type="text" id="school" name="data[school]" placeholder="Enter your school or institution" required>
            </div>
            
            <div class="input-group">
                <label for="phone">Phone Number <span class="required">*</span></label>
                <input type="tel" id="phone" name="data[phone]" placeholder="Enter your phone number" required>
            </div>
            
            <div class="input-group">
                <label for="experience">MUN Experience in number <span class="required">*</span></label>
                <textarea id="experience" name="data[experience]" rows="4" placeholder="" required></textarea>
            </div>
            
            <div class="input-group">
                <label>Committee Preferences</label>
                <div class="preference-group">
                    <select name="data[committee1]" required>
                        <option value="" selected disabled>Select Committee 1</option>
                        <option value="AIPPM">AIPPM</option>
                        <option value="UNSC">UNSC</option>
                        <option value="UNHRC">UNHRC</option>
                        <option value="UNODC">UNODC</option>
                        <option value="HCC">HCC</option>
                        <option value="CCC">CCC</option>
                        <option value="IP-photography">IP - Photography</option>
                        <option value="IP-Journalism">IP - Journalism</option>
                        <option value="IP-Caricature">IP - Caricature</option>
                        <option value="IP-Video">IP - Video Editing</option>
                </select>
                    <input type="text" name="data[portfolio1]" placeholder="Enter Portfolio 1 " required>
    </div>
            </div>
            
            <div class="input-group">
                <div class="preference-group">
                    <select name="data[commitee2]">
                        <option value="" selected disabled>Select Committee 2</option>
                        <option value="AIPPM">AIPPM</option>
                        <option value="UNSC">UNSC</option>
                        <option value="UNHRC">UNHRC</option>
                        <option value="UNODC">UNODC</option>
                        <option value="HCC">HCC</option>
                        <option value="CCC">CCC</option>
                        <option value="IP-photography">IP - Photography</option>
                        <option value="IP-Journalism">IP - Journalism</option>
                        <option value="IP-Caricature">IP - Caricature</option>
                        <option value="IP-Video">IP - Video Editing</option>
                        
                    </select>
                    <input type="text" name="data[portfolio2]" placeholder="Enter Portfolio 2 ">
            </div>
            </div>
            
            <div class="input-group">
                <label for="reference">Reference (if any)</label>
                <input type="text" id="reference" name="data[reference]" placeholder="Enter reference details">
            </div>
            
            <div class="form-footer">
                <div class="payment-section" style="margin-bottom: 20px; text-align: center;">
                    <label style="display: block; margin-bottom: 10px;">Payment Confirmation <span class="required">*</span></label>
                    <button type="button" id="payment-btn" class="btn" style="background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin-bottom: 10px;" onclick="openPaymentPortal()">
                        Access Payment Portal
                    </button>
                    <div style="margin-top: 5px;">
                        <input type="checkbox" id="payment-confirmed" onchange="updateSubmitButton()" disabled>
                        <label for="payment-confirmed">I confirm that I have completed the payment</label>
                    </div>
                </div>
                <button type="submit" id="submit-btn" class="btn btn-with-spinner" disabled style="opacity: 0.6; cursor: not-allowed;">
                    <span id="spinner" class="spinner"></span>
                    Submit Registration
                </button>
            </div>
        </form>
    </div>
    <script>
        var form = document.getElementById('sheetdb-form');
        var paymentAccessed = false;
        
        function openPaymentPortal() {
            window.open('https://forms.gle/87nt5JG1z8GAyBwY9', '_blank');
            paymentAccessed = true;
            document.getElementById('payment-confirmed').disabled = false;
            document.getElementById('payment-confirmed').focus();
        }

        function updateSubmitButton() {
            const submitBtn = document.getElementById('submit-btn');
            const paymentConfirmed = document.getElementById('payment-confirmed').checked;
            
            if (paymentAccessed && paymentConfirmed) {
                submitBtn.disabled = false;
                submitBtn.style.opacity = '1';
                submitBtn.style.cursor = 'pointer';
            } else {
                submitBtn.disabled = true;
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
            }
        }
        
        // Handle SheetDB form submission

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            
            if (!paymentAccessed || !document.getElementById('payment-confirmed').checked) {
                alert('Please access the payment portal and confirm your payment before submitting the form.');
                return;
            }
            
            // Get the form data
            const formData = new FormData(form);
            
            // Submit to SheetDB
            fetch(form.action, {
                method: "POST",
                body: new FormData(document.getElementById("sheetdb-form")),
            }).then(
                response => response.json()
            ).then((html) => {
                window.open('thankyou.html');
            });
        });
    

    </script>
</body>
</html>